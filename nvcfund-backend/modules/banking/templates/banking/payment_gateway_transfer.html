{% extends "unified_base.html" %}
{% from "components/nvc_components.html" import metric_card, action_card, account_card, transaction_row, form_input, form_select, notification_banner, progress_bar, stats_grid, loading_spinner, empty_state %}


{% block title %}{{ gateway }} Transfer - NVC Banking & Crypto Platform{% endblock %}

{% block page_title %}{{ gateway }} Payment Gateway{% endblock %}
{% block page_description %}Secure transfers using {{ gateway }} with traditional and digital currency support{% endblock %}

{% block page_actions %}
<button type="button" class="nvc-btn nvc-btn-outline-enterprise" data-action="custom-action">
    <i class="fas fa-history"></i>
    Transfer History
</button>
<button type="button" class="nvc-btn nvc-btn-secondary-enterprise" data-action="custom-action">
    <i class="fas fa-save"></i>
    Save Template
</button>
<button type="button" class="nvc-btn nvc-btn-primary-enterprise" data-action="custom-action">
    <i class="fas fa-paper-plane"></i>
    Send Transfer
</button>
{% endblock %}

{% block extra_js %}
<script>
// Payment Gateway Functions
function viewTransferHistory() {
    window.location.href = "{{ url_for('banking.transfer_history') }}";
}

function saveAsTemplate() {
    alert('Save as template functionality will be implemented');
}

function processTransfer() {
    const form = document.getElementById('gatewayTransferForm');
    if (form && form.checkValidity()) {
        alert('Gateway transfer processing will be implemented');
    } else if (form) {
        form.reportValidity();
    }
}
</script>
{% endblock %}

{% block content %}
<!-- Modern Payment Gateway Transfer -->
<div class="row g-4">
    <!-- Gateway Information -->
    <div class="col-12">
        <div class="nvc-card border-0 shadow-sm">
            <div class="nvc-nvc-card-body">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <div class="gateway-header">
                            <div class="gateway-logo">
                                {% if gateway == 'PayPal' %}
                                    <i class="fab fa-paypal text-primary" class="nvc-fs-2rem"></i>
                                {% elif gateway == 'Stripe' %}
                                    <i class="fab fa-stripe text-info" class="nvc-fs-2rem"></i>
                                {% elif gateway == 'Flutterwave' %}
                                    <i class="fas fa-credit-nvc-card text-warning" class="nvc-fs-2rem"></i>
                                {% elif gateway == 'Blockchain' %}
                                    <i class="fab fa-bitcoin text-warning" class="nvc-fs-2rem"></i>
                                {% else %}
                                    <i class="fas fa-university text-primary" class="nvc-fs-2rem"></i>
                                {% endif %}
                            </div>
                            <div class="gateway-info ms-3">
                                <h3 class="mb-1">{{ gateway }} Transfer</h3>
                                <p class="text-muted mb-0">
                                    {% if gateway == 'PayPal' %}
                                        Send money globally using PayPal's secure network
                                    {% elif gateway == 'Stripe' %}
                                        Fast and secure payments powered by Stripe
                                    {% elif gateway == 'Flutterwave' %}
                                        African payment gateway for local and international transfers
                                    {% elif gateway == 'Blockchain' %}
                                        Cryptocurrency transfers on blockchain networks
                                    {% else %}
                                        Secure money transfers using {{ gateway }} payment gateway
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="gateway-status">
                            <span class="badge bg-success fs-6">
                                <i class="fas fa-check-circle me-1"></i>
                                Connected
                            </span>
                            <div class="mt-2">
                                <small class="text-muted">
                                    {% if gateway == 'Blockchain' %}
                                        Network: Ethereum, Bitcoin
                                    {% else %}
                                        Processing Fee: 2.9% + $0.30
                                    {% endif %}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Transfer Form -->
    <div class="col-xl-8">
        <div class="nvc-card border-0 shadow-sm">
            <div class="nvc-nvc-card-header bg-transparent">
                <h5 class="nvc-card-title mb-0">
                    <i class="fas fa-paper-plane text-primary me-2"></i>
                    Transfer Details
                </h5>
            </div>
            <div class="nvc-nvc-card-body">
                <form id="gatewayTransferForm" class="needs-validation" novalidate>
                    <input type="hidden" name="gateway" value="{{ gateway }}">

                    <!-- Recipient Information -->
                    <div class="form-section mb-4">
                        <h6 class="text-primary mb-3">
                            <i class="fas fa-user text-primary me-2"></i>
                            Recipient Information
                        </h6>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="recipientEmail" class="nvc-form-label">
                                    {% if gateway == 'PayPal' %}
                                        PayPal Email Address
                                    {% elif gateway == 'Blockchain' %}
                                        Wallet Address
                                    {% else %}
                                        Email Address
                                    {% endif %}
                                </label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        {% if gateway == 'Blockchain' %}
                                            <i class="fas fa-wallet text-muted"></i>
                                        {% else %}
                                            <i class="fas fa-envelope text-muted"></i>
                                        {% endif %}
                                    </span>
                                    <input type="text" class="form-control nvc-form-input-lg"
                                           id="recipientEmail" name="recipientEmail" required
                                           placeholder="{% if gateway == 'Blockchain' %}0x...{% else %}recipient@example.com{% endif %}">
                                    <div class="invalid-feedback">
                                        Please provide a valid {% if gateway == 'Blockchain' %}wallet address{% else %}email address{% endif %}.
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="recipientName" class="nvc-form-label">Recipient Name</label>
                                <input type="text" class="form-control nvc-form-input-lg"
                                       id="recipientName" name="recipientName" required
                                       placeholder="Enter recipient's full name">
                                <div class="invalid-feedback">
                                    Please provide the recipient's name.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Transfer Amount -->
                    <div class="form-section mb-4">
                        <h6 class="text-success mb-3">
                            <i class="fas fa-dollar-sign text-success me-2"></i>
                            Transfer Amount
                        </h6>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="amount" class="nvc-form-label">Amount</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        {% if gateway == 'Blockchain' %}
                                            <select class="nvc-form-select border-0 bg-transparent" id="cryptoCurrency">
                                                <option value="BTC">â‚¿</option>
                                                <option value="ETH">Îž</option>
                                                <option value="NVCT">ðŸª™</option>
                                                <option value="USDC">ðŸ’Ž</option>
                                            </select>
                                        {% else %}
                                            $
                                        {% endif %}
                                    </span>
                                    <input type="number" class="form-control nvc-form-input-lg"
                                           id="amount" name="amount" required step="0.01" min="0.01"
                                           placeholder="0.00">
                                    <div class="invalid-feedback">
                                        Please enter a valid amount.
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="currency" class="nvc-form-label">Currency</label>
                                <select class="form-select nvc-form-select-lg" id="currency" name="currency" required>
                                    {% if gateway == 'Blockchain' %}
                                        <option value="BTC">Bitcoin (BTC)</option>
                                        <option value="ETH">Ethereum (ETH)</option>
                                        <option value="NVCT">NVCT Stablecoin</option>
                                        <option value="USDC">USD Coin (USDC)</option>
                                    {% else %}
                                        <option value="USD">US Dollar (USD)</option>
                                        <option value="EUR">Euro (EUR)</option>
                                        <option value="GBP">British Pound (GBP)</option>
                                        <option value="CAD">Canadian Dollar (CAD)</option>
                                    {% endif %}
                                </select>
                            </div>
                        </div>
                    </div>
                        </div>
                        <div class="text-end">
                            <a href="{{ url_for('banking.transfers') }}" class="btn nvc-btn nvc-btn-outline-light btn-sm">
                                <i class="fas fa-arrow-left"></i> Back to Transfers
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Transfer Form -->
                <div class="col-lg-8">
                    <div class="card dashboard-stat-nvc-card">
                        <div class="nvc-nvc-card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-paper-plane me-2"></i>{{ gateway }} Transfer Details
                            </h5>
                        </div>
                        <div class="nvc-nvc-card-body">
                            <form method="POST" class="needs-validation" novalidate>
                                <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
                                
                                <!-- Amount Section -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <label for="amount" class="nvc-form-label">Transfer Amount *</label>
                                        <div class="input-group">
                                            <span class="input-group-text">$</span>
                                            <input type="number" 
                                                   class="nvc-form-input" 
                                                   id="amount" 
                                                   name="amount" 
                                                   step="0.01" 
                                                   min="1" 
                                                   required>
                                            <div class="invalid-feedback">
                                                Please enter a valid amount.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="currency" class="nvc-form-label">Currency</label>
                                        <select class="nvc-form-select" id="currency" name="currency">
                                            <option value="USD" selected>USD - US Dollar</option>
                                            <option value="EUR">EUR - Euro</option>
                                            <option value="GBP">GBP - British Pound</option>
                                            <option value="CAD">CAD - Canadian Dollar</option>
                                            {% if gateway_id == 'flutterwave' %}
                                            <option value="NGN">NGN - Nigerian Naira</option>
                                            <option value="KES">KES - Kenyan Shilling</option>
                                            <option value="GHS">GHS - Ghanaian Cedi</option>
                                            {% endif %}
                                        </select>
                                    </div>
                                </div>

                                <!-- Recipient Section -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <label for="recipient" class="nvc-form-label">
                                            {% if gateway_id == 'paypal' %}Recipient PayPal Email{% endif %}
                                            {% if gateway_id == 'stripe' %}Recipient Account{% endif %}
                                            {% if gateway_id == 'flutterwave' %}Recipient Phone/Email{% endif %}
                                            {% if gateway_id == 'mojaloop' %}Recipient ID{% endif %}
                                            {% if gateway_id == 'mobile' %}Mobile Number{% endif %}
                                            *
                                        </label>
                                        <input type="text" 
                                               class="nvc-form-input" 
                                               id="recipient" 
                                               name="recipient" 
                                               placeholder="{% if gateway_id == 'paypal' %}user@example.com{% endif %}{% if gateway_id == 'stripe' %}acct_xxxxxxxxxxxxxxxx{% endif %}{% if gateway_id == 'flutterwave' %}+234XXXXXXXXXX{% endif %}{% if gateway_id == 'mojaloop' %}participant-id{% endif %}{% if gateway_id == 'mobile' %}+1234567890{% endif %}"
                                               required>
                                        <div class="invalid-feedback">
                                            Please enter a valid recipient identifier.
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="description" class="nvc-form-label">Transfer Description</label>
                                        <input type="text" 
                                               class="nvc-form-input" 
                                               id="description" 
                                               name="description" 
                                               placeholder="Payment for services"
                                               maxlength="100">
                                        <div class="form-text">Optional description for this transfer</div>
                                    </div>
                                </div>

                                <!-- Gateway Specific Information -->
                                <div class="alert nvc-nvc-alert-info">
                                    <h6 class="nvc-alert-heading">{{ gateway }} Transfer Information</h6>
                                    {% if gateway_id == 'paypal' %}
                                    <p class="mb-2"><strong>Processing Time:</strong> Instant</p>
                                    <p class="mb-2"><strong>Fee:</strong> 3.49% + $0.49</p>
                                    <p class="mb-2"><strong>Limit:</strong> $60,000 per transaction</p>
                                    <p class="mb-0"><small>Funds will be sent to the recipient's PayPal account instantly.</small></p>
                                    {% elif gateway_id == 'stripe' %}
                                    <p class="mb-2"><strong>Processing Time:</strong> 2-7 business days</p>
                                    <p class="mb-2"><strong>Fee:</strong> 2.9% + $0.30</p>
                                    <p class="mb-2"><strong>Limit:</strong> $2,000,000 per transaction</p>
                                    <p class="mb-0"><small>Transfer will be processed through Stripe's secure payment network.</small></p>
                                    {% elif gateway_id == 'flutterwave' %}
                                    <p class="mb-2"><strong>Processing Time:</strong> 1-3 business days</p>
                                    <p class="mb-2"><strong>Fee:</strong> 1.4% + $0.25</p>
                                    <p class="mb-2"><strong>Limit:</strong> $500,000 per transaction</p>
                                    <p class="mb-0"><small>Transfer across Africa with support for mobile money and local banking.</small></p>
                                    {% elif gateway_id == 'mojaloop' %}
                                    <p class="mb-2"><strong>Processing Time:</strong> Real-time</p>
                                    <p class="mb-2"><strong>Fee:</strong> $0.05 flat fee</p>
                                    <p class="mb-2"><strong>Limit:</strong> $25,000 per transaction</p>
                                    <p class="mb-0"><small>Open-source financial inclusion platform for instant transfers.</small></p>
                                    {% elif gateway_id == 'mobile' %}
                                    <p class="mb-2"><strong>Processing Time:</strong> Instant</p>
                                    <p class="mb-2"><strong>Fee:</strong> $2.00 flat fee</p>
                                    <p class="mb-2"><strong>Limit:</strong> $10,000 per transaction</p>
                                    <p class="mb-0"><small>Send money directly to mobile wallets and payment apps.</small></p>
                                    {% endif %}
                                </div>

                                <!-- Action Buttons -->
                                <div class="d-flex gap-3">
                                    <button type="submit" class="btn nvc-btn nvc-btn-primary btn-lg">
                                        <i class="fas fa-paper-plane me-2"></i>Send {{ gateway }} Transfer
                                    </button>
                                    <a href="{{ url_for('banking.transfers') }}" class="btn nvc-btn nvc-btn-outline-secondary btn-lg">
                                        <i class="fas fa-times me-2"></i>Cancel
                                    </a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Gateway Information Sidebar -->
                <div class="col-lg-4">
                    <div class="card dashboard-stat-nvc-card">
                        <div class="nvc-nvc-card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-info-circle me-2"></i>{{ gateway }} Gateway
                            </h5>
                        </div>
                        <div class="nvc-nvc-card-body">
                            <!-- Gateway Logo -->
                            <div class="text-center mb-4">
                                {% if gateway_id == 'paypal' %}
                                <div class="gateway-logo paypal-logo mx-auto mb-3 nvc-style-045ed1" >
                                    <div class="paypal-p">P</div>
                                    <span class="logo-text">PAYPAL</span>
                                </div>
                                {% elif gateway_id == 'stripe' %}
                                <div class="gateway-logo stripe-logo mx-auto mb-3 nvc-style-045ed1" >
                                    <div class="stripe-s">S</div>
                                    <span class="logo-text">STRIPE</span>
                                </div>
                                {% elif gateway_id == 'flutterwave' %}
                                <div class="gateway-logo flutterwave-logo mx-auto mb-3 nvc-style-045ed1" >
                                    <div class="flutter-icon">â–²</div>
                                    <span class="logo-text">FLUTTER</span>
                                </div>
                                {% elif gateway_id == 'mojaloop' %}
                                <div class="gateway-logo mojaloop-logo mx-auto mb-3 nvc-style-045ed1" >
                                    <div class="moja-icon">â—‹</div>
                                    <span class="logo-text">MOJA</span>
                                </div>
                                {% elif gateway_id == 'mobile' %}
                                <div class="gateway-logo mobile-logo mx-auto mb-3 nvc-style-045ed1" >
                                    <div class="mobile-icon">ðŸ“±</div>
                                    <span class="logo-text">MOBILE</span>
                                </div>
                                {% endif %}
                                <span class="badge bg-success">LIVE</span>
                            </div>

                            <!-- Gateway Features -->
                            <div class="mb-4">
                                <h6 class="text-light mb-3">Key Features</h6>
                                <ul class="list-unstyled">
                                    {% if gateway_id == 'paypal' %}
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Global reach</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Buyer protection</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Mobile app</li>
                                    {% elif gateway_id == 'stripe' %}
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Developer-friendly</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Global coverage</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Real-time API</li>
                                    {% elif gateway_id == 'flutterwave' %}
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Pan-African</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Multiple currencies</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Mobile money</li>
                                    {% elif gateway_id == 'mojaloop' %}
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Financial inclusion</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Interoperability</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Low cost</li>
                                    {% elif gateway_id == 'mobile' %}
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Mobile-friendly</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>QR codes</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Push notifications</li>
                                    {% endif %}
                                </ul>
                            </div>

                            <!-- Security Information -->
                            <div class="alert nvc-nvc-alert-success">
                                <h6 class="nvc-alert-heading">Secure Transfer</h6>
                                <p class="mb-0">All transfers are secured with banking-grade encryption and fraud detection.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Gateway Logo Styles */
.gateway-logo {
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
    position: relative;
    transition: all 0.3s ease;
}

/* PayPal Logo */
.paypal-logo {
    background: linear-gradient(135deg, #003087 0%, #009cde 100%);
    color: white;
    flex-direction: row;
    gap: 4px;
}

.paypal-p {
    width: 20px;
    height: 20px;
    background: #ffc439;
    color: #003087;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 900;
    font-style: italic;
}

.paypal-logo .logo-text {
    font-size: 9px;
    font-weight: 700;
}

/* Stripe Logo */
.stripe-logo {
    background: linear-gradient(135deg, #635bff 0%, #5851e6 100%);
    color: white;
    flex-direction: row;
    gap: 4px;
}

.stripe-s {
    width: 18px;
    height: 18px;
    background: white;
    color: #635bff;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 900;
    font-style: italic;
}

.stripe-logo .logo-text {
    font-size: 9px;
    font-weight: 700;
}

/* Flutterwave Logo */
.flutterwave-logo {
    background: linear-gradient(135deg, #f5a623 0%, #f39019 100%);
    color: white;
    flex-direction: row;
    gap: 4px;
}

.flutter-icon {
    font-size: 16px;
    font-weight: 900;
    color: white;
    transform: rotate(90deg);
}

.flutterwave-logo .logo-text {
    font-size: 8px;
    font-weight: 700;
}

/* Mojaloop Logo */
.mojaloop-logo {
    background: linear-gradient(135deg, #00a651 0%, #007d3c 100%);
    color: white;
    flex-direction: row;
    gap: 4px;
}

.moja-icon {
    width: 18px;
    height: 18px;
    border: 2px solid white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 8px;
    font-weight: 900;
}

.mojaloop-logo .logo-text {
    font-size: 10px;
    font-weight: 700;
}

/* Mobile Logo */
.mobile-logo {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    flex-direction: row;
    gap: 4px;
}

.mobile-icon {
    font-size: 16px;
}

.mobile-logo .logo-text {
    font-size: 9px;
    font-weight: 700;
}
</style>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>