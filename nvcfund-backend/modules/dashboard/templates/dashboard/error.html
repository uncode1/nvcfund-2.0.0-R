
{% extends "unified_base.html" %}
{% from "components/nvc_components.html" import metric_card, action_card, account_card, transaction_row, form_input, form_select, notification_banner, progress_bar, stats_grid, loading_spinner, empty_state %}


{% block title %}Dashboard Error - NVC Banking & Crypto Platform{% endblock %}

{% block page_title %}System Error{% endblock %}
{% block page_description %}An error occurred while processing your request{% endblock %}

{% block page_actions %}
<button type="button" class="nvc-btn nvc-btn-outline-enterprise" data-action="custom-action">
    <i class="fas fa-bug"></i>
    Report Error
</button>
<button type="button" class="nvc-btn nvc-btn-secondary-enterprise" data-action="custom-action">
    <i class="fas fa-arrow-left"></i>
    Go Back
</button>
<button type="button" class="nvc-btn nvc-btn-primary-enterprise" data-action="custom-action">
    <i class="fas fa-home"></i>
    Go Home
</button>
{% endblock %}

{% block extra_js %}
<script>
function reportError() {
    const errorDetails = {
        url: window.location.href,
        timestamp: new Date().toISOString(),
        userAgent: navigator.userAgent
    };

    fetch('/dashboard/report-error', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': document.querySelector('[name=csrf_token]')?.value
        },
        body: JSON.stringify(errorDetails)
    }).then(response => {
        if (response.ok) {
            alert('Error reported successfully. Thank you for your feedback.');
        } else {
            alert('Failed to report error. Please try again later.');
        }
    });
}

function goBack() {
    window.history.back();
}

function goHome() {
    window.location.href = "{{ url_for('dashboard.main_dashboard') }}";
}
</script>
{% endblock %}

{% block content %}
<div class="nvc-page-content">
    <div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="nvc-card border-danger">
                <div class="nvc-nvc-card-header bg-danger text-white">
                    <h4 class="mb-0">
                        <i class="fas fa-exclamation-triangle"></i> Dashboard Error
                    </h4>
                </div>
                <div class="nvc-nvc-card-body">
                    <h5>{{ error_message or 'An error occurred while loading the dashboard.' }}</h5>
                    <p>We're experiencing technical difficulties. Please try again in a few moments.</p>

                    <div class="mt-4">
                        <button type="button" data-action="reload-page" class="btn nvc-btn nvc-btn-primary">
                            <i class="fas fa-redo"></i> Retry
                        </button>
                        <a href="/" class="btn nvc-btn nvc-btn-outline-secondary">
                            <i class="fas fa-home"></i> Go Home
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
{% endblock %}
